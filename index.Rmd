---
title: "Can we have it all?"
author: "Philip Unger & Philipp Staender"
date: "13 May 2016"
output: html_document
bibliography: 
- main.bib
- packages.bib
---

```{r setup, include=FALSE}
library(dplyr)
library(ggplot2)
library(plotly)
library(repmis)
library(plyr)
library(MASS)
library(Hmisc)
library(interplot)
library(gridExtra)
library(car)
library(reshape)
library(gmodels)
library(quantmod)
library(foreign)
library(stargazer)

load("~/R_data/Final_Project_P-P/data/data_final.rda")

```

![](lead_large.jpg)

*This website presents findings from the research project "Can we have it all?" in which we explore the reconcilability of work and family and its effect on life satisfaction of US adults.*

In western societies having a job and pursuing a fulfilling career is a major life goal. At the same time the attempt to tear down the male-breadwinner norm has moved the reconciliation of family and work more into the focus for many couples. We are interested whether the progressive ideal of combining career and family is also rewarded with higher life happiness. On the other hand "having it all" might also imply a more stressful life, where different roles of being a dedicated worker and a caring partner or parent might clash with each other.


**Facts and findings that motivated our project:**

- Working time within couplesis is still very unequally distributed across industrialized countries with men working much more than women [@hipp2015].
- Men and women seem to have different preferences for working full-time or part-time. Men prefer working full-time, while women report higher-life satisfaction in part-time jobs [@booth2008].
- Having a family contributes more strongly to womenâ€™s happiness than having a career. Reported happiness is higher for women who have a family and no career relative to women with both [@bertrand2013].

**Goal of the project**




**Figure 1**
```{r warning=FALSE,echo=FALSE,cache=TRUE,fig.cap="Distribution of reported happiness and job-satisfaction"}

happy_dist <- table(z$happy)/sum(table(z$happy))*100
satjob_dist <- table(z$satjob)/sum(table(z$happy))*100

par(mfrow=c(1,2)) 

barplot(happy_dist, 
        col=c("navyblue"),
        xlab = "Reported happiness",
        ylab = "Frequency (percent)",
        legend = c("Happiness"),
        ylim = c(0, 80))  

barplot(satjob_dist, 
        col=c("navyblue"),
        xlab = "Reported job-satisfaction",
        legend = c("Job-satisfcation"),
        ylim = c(0, 80))
```

``` {r, warning=FALSE,echo=FALSE,fig.cap="Average reported happiness over survey year, 1972-2014"}

fig_survyear <- ddply(z, c("year"), summarise,
              vhappyb = mean(vhappyb, na.rm=TRUE))

fig_survyear <- na.omit(fig_survyear)

ggplot() +
    geom_point(data = fig_survyear, aes(x=year, y=vhappyb), color="Navyblue") +
    stat_smooth(data = fig_survyear, aes(x=year, y=vhappyb), method ="loess", col = "Navyblue") +
    scale_y_continuous("Percentage very happy") +
    scale_x_continuous("Survey Year") +
    expand_limits(y=c(25,45)) +
    theme_bw()

```

**plotly graph**
``` {r, warning=FALSE,echo=FALSE,fig.cap="Average reported happiness over survey year, 1972-2014"}

fig_survyear <- ddply(z, c("year"), summarise,
              vhappyb = mean(vhappyb, na.rm=TRUE))

fig_survyear <- na.omit(fig_survyear)

hap_year <- ggplot() +
                geom_point(data = fig_survyear, aes(x=year, y=vhappyb), color="Navyblue") +
                stat_smooth(data = fig_survyear, aes(x=year, y=vhappyb), method ="loess", col = "Navyblue") +
                scale_y_continuous("Percentage very happy") +
                scale_x_continuous("Survey Year") +
                expand_limits(y=c(25,45)) +
                theme_bw()
hap_year
#ggplotly(hap_year)
```

```{r,warning=FALSE,echo=FALSE,fig.cap="Happiness and age (college educated men and women)"}

fig_age <- ddply(z[z$educat==4,], c("age", "sex"), summarise,
              vhappyb = mean(vhappyb, na.rm=TRUE))

fig_age <- na.omit(fig_age)

ggplot() +
                geom_point(data = fig_age[fig_age$sex == 1,], aes(x=age, y=vhappyb), color="Navyblue") + 
                geom_point(data = fig_age[fig_age$sex == 2,], aes(x=age, y=vhappyb), color="Red") +
                stat_smooth(data = fig_age[fig_age$sex == 1,], aes(x=age, y=vhappyb), method ="loess", se = FALSE, col="Navyblue") +
                stat_smooth(data = fig_age[fig_age$sex == 2,], aes(x=age, y=vhappyb), method ="loess", se = FALSE, col="Red") +
                expand_limits(y=c(20,60)) +
                scale_x_continuous("Age") +
                scale_y_continuous("Percentage very happy") +
                expand_limits(y=c(20,60)) +
                theme_bw()

```

**Second plotly graph**
```{r,warning=FALSE,echo=FALSE,fig.cap="Happiness and age (college educated men and women)"}

fig_age <- ddply(z[z$educat==4,], c("age", "sex"), summarise,
              vhappyb = mean(vhappyb, na.rm=TRUE))

fig_age <- na.omit(fig_age)

hap_age <- ggplot() +
                geom_point(data = fig_age[fig_age$sex == 1,], aes(x=age, y=vhappyb), color="Navyblue") + 
                geom_point(data = fig_age[fig_age$sex == 2,], aes(x=age, y=vhappyb), color="Red") +
                stat_smooth(data = fig_age[fig_age$sex == 1,], aes(x=age, y=vhappyb), method ="loess", se = FALSE, col="Navyblue") +
                stat_smooth(data = fig_age[fig_age$sex == 2,], aes(x=age, y=vhappyb), method ="loess", se = FALSE, col="Red") +
                expand_limits(y=c(20,60)) +
                scale_x_continuous("Age") +
                scale_y_continuous("Percentage very happy") +
                expand_limits(y=c(20,60)) +
                theme_bw()
hap_age
#ggplotly(hap_age)
```

**Grid arrange figure**
```{r, fig.height=6, warning=FALSE,echo=FALSE,cache=TRUE,fig.cap="Distribution of income"}

par(mfrow=c(2,1))
hist(z$def_rinc[z$sex == 1 & z$educat == 4],
     col = c("Navyblue"),
     border = "White",
     xlim = c(0,250000),
     breaks = 20,
     xlab = "Respondent's income (College educated men)",
     main = ""
     )

hist(z$def_rinc[z$sex == 2 & z$educat ==4],
     col = c("Darkred"),
     border = "White",
     xlim = c(0,250000),
     breaks = 20,
     xlab = "Respondent's income (College educated women)",
     main = ""
     )
```